% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/linda2.R
\name{get_tree_smoothing_info}
\alias{get_tree_smoothing_info}
\title{Compute Tree-Guided Smoothing Matrix and Corrections}
\usage{
get_tree_smoothing_info(
  phy.tree,
  tax.names,
  lambda = 0.1,
  k.neighbors = 5,
  meff.exponent = 2.2
)
}
\arguments{
\item{phy.tree}{A phylo object (from ape package) representing the phylogenetic tree}

\item{tax.names}{Character vector of taxa names (must match tree tip labels)}

\item{lambda}{Numeric; smoothing strength parameter (default 0.1)}

\item{k.neighbors}{Integer; number of nearest neighbors for local smoothing (default 5)}

\item{meff.exponent}{Numeric; exponent for M_eff correction (default 2.2)}
}
\value{
A list containing:
  \item{S}{The smoothing matrix (M x M)}
  \item{var.correction}{Vector of variance correction factors for each taxon}
  \item{meff.correction}{Scalar M_eff correction factor for p-values}
  \item{trace.ratio}{The trace ratio trace(S)/M used in M_eff calculation}
  \item{n.matched}{Number of taxa matched to tree tips}
}
\description{
Internal function that constructs a local KNN smoothing matrix from a
phylogenetic tree and computes the necessary correction factors.
}
\keyword{internal}
