% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/linda2.R
\name{get_tree_smoothing_info}
\alias{get_tree_smoothing_info}
\title{Compute Tree-Guided Smoothing Information (Sparse Optimized)}
\usage{
get_tree_smoothing_info(phy.tree, tax.names, lambda = 0.1, k.neighbors = 5)
}
\arguments{
\item{phy.tree}{A phylo object (from ape package) representing the phylogenetic tree}

\item{tax.names}{Character vector of taxa names (must match tree tip labels)}

\item{lambda}{Numeric; smoothing strength parameter (default 0.1)}

\item{k.neighbors}{Integer; number of nearest neighbors for local smoothing (default 5)}
}
\value{
A list containing:
  \item{chol_factor}{Sparse Cholesky factor for solving S*t = A^{-1}*t}
  \item{var.correction}{Global variance correction factor (scalar)}
  \item{meff}{Effective number of tests M_eff = tr(S^2)^2 / tr(S^4)}
  \item{meff.correction}{M_eff / M ratio for p-value adjustment}
  \item{rho}{Correlation between baseline and smoothed statistics for Max-T omnibus}
  \item{n.matched}{Number of taxa matched to tree tips}
  \item{matched.idx}{Indices of taxa matched to tree in full M-dimensional space}
}
\description{
Internal function that constructs a local KNN smoothing matrix from a
phylogenetic tree and computes the necessary correction factors.
}
\details{
OPTIMIZATION: Uses sparse Cholesky decomposition and Hutchinson trace
estimation to avoid computing the full S = A^{-1} matrix. This reduces
complexity from O(M³) to O(M² × k) and achieves ~2000x speedup for
large datasets (M > 5000 taxa).
}
\keyword{internal}
