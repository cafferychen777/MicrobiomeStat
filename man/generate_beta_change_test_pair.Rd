% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_beta_change_test_pair.R
\name{generate_beta_change_test_pair}
\alias{generate_beta_change_test_pair}
\title{Test Beta Diversity Change Between Time Points}
\usage{
generate_beta_change_test_pair(
  data.obj,
  dist.obj = NULL,
  subject.var,
  time.var = NULL,
  group.var,
  adj.vars = NULL,
  change.base = NULL,
  dist.name = c("BC", "Jaccard", "UniFrac", "GUniFrac", "WUniFrac", "JS")
)
}
\arguments{
\item{data.obj}{A MicrobiomeStat data object, which is a list containing
at minimum the following components:
\itemize{
  \item \code{feature.tab}: A matrix of feature abundances (taxa/genes as
    rows, samples as columns)
  \item \code{meta.dat}: A data frame of sample metadata (samples as rows)
}
Optional components include:
\itemize{
  \item \code{feature.ann}: A matrix/data frame of feature annotations
    (e.g., taxonomy)
  \item \code{tree}: A phylogenetic tree object (class "phylo")
  \item \code{feature.agg.list}: Pre-aggregated feature tables by taxonomy
}
Data objects can be created using converters like
\code{\link{mStat_convert_phyloseq_to_data_obj}} or importers like
\code{\link{mStat_import_qiime2_as_data_obj}}.}

\item{dist.obj}{A list of pre-calculated distance matrices. If NULL and
distances are needed, they will be calculated automatically.
List names should match dist.name (e.g., "BC" for Bray-Curtis).
See \code{\link{mStat_calculate_beta_diversity}}.}

\item{subject.var}{Character string specifying the column name in meta.dat
that uniquely identifies each subject or sample unit. Required for
longitudinal and paired designs to track repeated measurements.}

\item{time.var}{Character string specifying the column name in meta.dat
containing the time variable. Required for longitudinal and paired analyses.
Should be a factor or character with meaningful time point labels.}

\item{group.var}{Character string specifying the column name in meta.dat
containing the grouping variable (e.g., treatment, condition, phenotype).
Used for between-group comparisons.}

\item{adj.vars}{Character vector specifying column names in meta.dat to be
used as covariates for adjustment in statistical models. These variables
will be included as fixed effects.}

\item{change.base}{Character or numeric specifying the baseline time point.
If NULL, uses the first time point.}

\item{dist.name}{Character vector specifying which distance metrics to use.
Options depend on available methods:
\itemize{
  \item "BC": Bray-Curtis dissimilarity
  \item "Jaccard": Jaccard distance
  \item "UniFrac": Unweighted UniFrac (requires tree)
  \item "GUniFrac": Generalized UniFrac (requires tree)
  \item "WUniFrac": Weighted UniFrac (requires tree)
  \item "JS": Jensen-Shannon divergence
}}
}
\value{
A named list containing linear modeling results for each beta diversity metric.
Each list element corresponds to one of the distance metrics specified in \code{dist.name}.
It contains a coefficient table from fitting a linear model with the beta diversity change as
response and the \code{group_var} and \code{adj_vars} as predictors.
If \code{group_var} has multiple levels, ANOVA results are also included after the coefficients.
Column names include:
Term, Estimate, Std.Error, Statistic, P.Value
}
\description{
Tests within-subject beta diversity changes between two time points using
linear models. Supports group comparisons and covariate adjustment.
}
\examples{
\dontrun{

# Load packages
library(vegan)

# Load data
data(peerj32.obj)
generate_beta_change_test_pair(
  data.obj = peerj32.obj,
  dist.obj = NULL,
  subject.var = "subject",
  time.var = "time",
  group.var = "group",
  adj.vars = NULL,
  change.base = "1",
  dist.name = c('BC', 'Jaccard')
)
generate_beta_change_test_pair(
  data.obj = peerj32.obj,
  dist.obj = NULL,
  subject.var = "subject",
  time.var = "time",
  group.var = "group",
  adj.vars = "sex",
  change.base = "1",
  dist.name = c('BC', 'Jaccard')
)

data("subset_pairs.obj")
generate_beta_change_test_pair(
  data.obj = subset_pairs.obj,
  dist.obj = NULL,
  subject.var = "MouseID",
  time.var = "Antibiotic",
  group.var = "Sex",
  adj.vars = NULL,
  change.base = "Baseline",
  dist.name = c('BC', 'Jaccard')
)
}
}
