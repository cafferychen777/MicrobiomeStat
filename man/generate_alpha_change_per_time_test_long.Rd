% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_alpha_change_per_time_test_long.R
\name{generate_alpha_change_per_time_test_long}
\alias{generate_alpha_change_per_time_test_long}
\title{Alpha Diversity Change Test Per Time Point (Longitudinal)}
\usage{
generate_alpha_change_per_time_test_long(
  data.obj,
  alpha.obj = NULL,
  alpha.name = NULL,
  depth = NULL,
  time.var,
  t0.level,
  ts.levels,
  subject.var,
  group.var,
  adj.vars = NULL,
  alpha.change.func = "log fold change"
)
}
\arguments{
\item{data.obj}{A MicrobiomeStat data object, which is a list containing
at minimum the following components:
\itemize{
  \item \code{feature.tab}: A matrix of feature abundances (taxa/genes as
    rows, samples as columns)
  \item \code{meta.dat}: A data frame of sample metadata (samples as rows)
}
Optional components include:
\itemize{
  \item \code{feature.ann}: A matrix/data frame of feature annotations
    (e.g., taxonomy)
  \item \code{tree}: A phylogenetic tree object (class "phylo")
  \item \code{feature.agg.list}: Pre-aggregated feature tables by taxonomy
}
Data objects can be created using converters like
\code{\link{mStat_convert_phyloseq_to_data_obj}} or importers like
\code{\link{mStat_import_qiime2_as_data_obj}}.}

\item{alpha.obj}{A list containing pre-calculated alpha diversity indices.
If NULL and alpha diversity is needed, it will be calculated automatically.
Names should match the alpha.name parameter (e.g., "shannon", "simpson").
See \code{\link{mStat_calculate_alpha_diversity}}.}

\item{alpha.name}{Character vector specifying which alpha diversity indices
to analyze. Options include:
\itemize{
  \item "shannon": Shannon diversity index
  \item "simpson": Simpson diversity index
  \item "observed_species": Observed species richness
  \item "chao1": Chao1 richness estimator
  \item "ace": ACE richness estimator
  \item "pielou": Pielou's evenness
}}

\item{depth}{Numeric value or NULL. Rarefaction depth for diversity
calculations. If NULL, uses minimum sample depth or no rarefaction.}

\item{time.var}{Character string specifying the column name in meta.dat
containing the time variable. Required for longitudinal and paired analyses.
Should be a factor or character with meaningful time point labels.}

\item{t0.level}{Character or numeric value specifying the baseline time
point for longitudinal or paired analyses. Should match a value in the
time.var column.}

\item{ts.levels}{Character vector specifying the follow-up time points for
longitudinal or paired analyses. Should match values in the time.var column.}

\item{subject.var}{Character string specifying the column name in meta.dat
that uniquely identifies each subject or sample unit. Required for
longitudinal and paired designs to track repeated measurements.}

\item{group.var}{Character string specifying the column name in meta.dat
containing the grouping variable (e.g., treatment, condition, phenotype).
Used for between-group comparisons.}

\item{adj.vars}{Character vector specifying column names in meta.dat to be
used as covariates for adjustment in statistical models. These variables
will be included as fixed effects.}

\item{alpha.change.func}{Function or method for calculating change in alpha diversity
between two timepoints. Options include 'log fold change', 'absolute change',
or a custom function.}
}
\value{
A list of tables, one for each alpha diversity metric, summarizing the results of the statistical tests.
}
\description{
Performs paired tests comparing alpha diversity changes between
  baseline and each follow-up time point in longitudinal data.
}
\examples{
\dontrun{
library(vegan)
data(peerj32.obj)
# Perform the longitudinal alpha diversity test for the peerj32 dataset
alpha_test_results_peerj32 <- generate_alpha_change_per_time_test_long(
  data.obj = peerj32.obj,
  alpha.obj = NULL,
  alpha.name = c("shannon", "simpson", "observed_species", "chao1", "ace", "pielou"),
  time.var = "time",
  t0.level = unique(peerj32.obj$meta.dat$time)[1],
  ts.levels = unique(peerj32.obj$meta.dat$time)[-1],
  subject.var = "subject",
  group.var = "sex",
  adj.vars = "group",
  alpha.change.func = "log fold change"
)
# Generate dot plots for the peerj32 dataset results
generate_alpha_per_time_dotplot_long(
  data.obj = peerj32.obj,
  test.list = alpha_test_results_peerj32,
  group.var = "sex",
  time.var = "time",
  t0.level = unique(peerj32.obj$meta.dat$time)[1],
  ts.levels = unique(peerj32.obj$meta.dat$time)[-1],
  base.size = 16,
  theme.choice = "bw"
)

# Perform the longitudinal alpha diversity test for the peerj32 dataset without adjustment variables
alpha_test_results_peerj32_no_adj <- generate_alpha_change_per_time_test_long(
  data.obj = peerj32.obj,
  alpha.obj = NULL,
  alpha.name = c("shannon", "simpson", "observed_species", "chao1", "ace", "pielou"),
  time.var = "time",
  t0.level = unique(peerj32.obj$meta.dat$time)[1],
  ts.levels = unique(peerj32.obj$meta.dat$time)[-1],
  subject.var = "subject",
  group.var = "sex",
  adj.vars = NULL,
  alpha.change.func = "log fold change"
)
# Generate dot plots for the peerj32 dataset results without adjustment variables
generate_alpha_per_time_dotplot_long(
  data.obj = peerj32.obj,
  test.list = alpha_test_results_peerj32_no_adj,
  group.var = "sex",
  time.var = "time",
  t0.level = unique(peerj32.obj$meta.dat$time)[1],
  ts.levels = unique(peerj32.obj$meta.dat$time)[-1],
  base.size = 16,
  theme.choice = "minimal"
)

data("subset_T2D.obj")
# Perform the longitudinal alpha diversity test for the T2D dataset
alpha_test_results_T2D <- generate_alpha_change_per_time_test_long(
  data.obj = subset_T2D.obj,
  alpha.name = c("shannon", "simpson", "observed_species", "chao1", "ace", "pielou"),
  time.var = "visit_number",
  t0.level = unique(subset_T2D.obj$meta.dat$visit_number)[1],
  ts.levels = unique(subset_T2D.obj$meta.dat$visit_number)[-1],
  subject.var = "subject_id",
  group.var = "subject_race",
  adj.vars = c("sample_body_site"),
  alpha.change.func = "log fold change"
)
# Generate dot plots for the T2D dataset results
dot_plots_T2D <- generate_alpha_per_time_dotplot_long(
  data.obj = subset_T2D.obj,
  test.list = alpha_test_results_T2D,
  group.var = "subject_race",
  time.var = "visit_number",
  t0.level = unique(subset_T2D.obj$meta.dat$visit_number)[1],
  ts.levels = unique(subset_T2D.obj$meta.dat$visit_number)[-1],
  base.size = 16,
  theme.choice = "bw"
)

# Perform the longitudinal alpha diversity test for the T2D dataset without adjustment variables
alpha_test_results_T2D_no_adj <- generate_alpha_change_per_time_test_long(
  data.obj = subset_T2D.obj,
  alpha.name = c("shannon", "simpson", "observed_species", "chao1", "ace", "pielou"),
  time.var = "visit_number",
  t0.level = unique(subset_T2D.obj$meta.dat$visit_number)[1],
  ts.levels = unique(subset_T2D.obj$meta.dat$visit_number)[-1],
  subject.var = "subject_id",
  group.var = "subject_race",
  adj.vars = NULL,
  alpha.change.func = "log fold change"
)
# Generate dot plots for the T2D dataset results without adjustment variables
dot_plots_T2D_no_adj <- generate_alpha_per_time_dotplot_long(
  data.obj = subset_T2D.obj,
  test.list = alpha_test_results_T2D_no_adj,
  group.var = "subject_race",
  time.var = "visit_number",
  t0.level = unique(subset_T2D.obj$meta.dat$visit_number)[1],
  ts.levels = unique(subset_T2D.obj$meta.dat$visit_number)[-1],
  base.size = 16,
  theme.choice = "bw"
)
}
}
