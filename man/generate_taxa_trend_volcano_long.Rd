% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_taxa_trend_volcano_long.R
\name{generate_taxa_trend_volcano_long}
\alias{generate_taxa_trend_volcano_long}
\title{Generate Volcano Plots for Longitudinal Taxa Trend Test}
\usage{
generate_taxa_trend_volcano_long(
  data.obj,
  group.var = NULL,
  time.var = NULL,
  test.list,
  feature.sig.level = 0.1,
  feature.mt.method = "fdr",
  features.plot = NULL,
  palette = c("white", "#7FB695", "#006D2C"),
  pdf = FALSE,
  pdf.wid = 7,
  pdf.hei = 5
)
}
\arguments{
\item{data.obj}{A MicrobiomeStat data object, which is a list containing
at minimum the following components:
\itemize{
  \item \code{feature.tab}: A matrix of feature abundances (taxa/genes as
    rows, samples as columns)
  \item \code{meta.dat}: A data frame of sample metadata (samples as rows)
}
Optional components include:
\itemize{
  \item \code{feature.ann}: A matrix/data frame of feature annotations
    (e.g., taxonomy)
  \item \code{tree}: A phylogenetic tree object (class "phylo")
  \item \code{feature.agg.list}: Pre-aggregated feature tables by taxonomy
}
Data objects can be created using converters like
\code{\link{mStat_convert_phyloseq_to_data_obj}} or importers like
\code{\link{mStat_import_qiime2_as_data_obj}}.}

\item{group.var}{Character string specifying the column name in meta.dat
containing the grouping variable (e.g., treatment, condition, phenotype).
Used for between-group comparisons.}

\item{time.var}{Character string specifying the column name in meta.dat
containing the time variable. Required for longitudinal and paired analyses.
Should be a factor or character with meaningful time point labels.}

\item{test.list}{List of test results from generate_taxa_trend_test_long.}

\item{feature.sig.level}{Numeric; significance level cutoff for highlighting taxa.}

\item{feature.mt.method}{Character; multiple testing method ("fdr" or "none").}

\item{features.plot}{Character vector of features to plot. If NULL, plots all.}

\item{palette}{Character vector of colors or a named palette for the plot.
If NULL, uses default MicrobiomeStat color scheme. Can be:
\itemize{
  \item A vector of color codes (e.g., c("#E41A1C", "#377EB8"))
  \item A palette name recognized by the plotting function
}}

\item{pdf}{Logical. If TRUE, saves the plot(s) to PDF file(s) in the
current working directory. Default is TRUE.}

\item{pdf.wid}{Numeric value specifying the width of PDF output in inches.
Default is typically 11.}

\item{pdf.hei}{Numeric value specifying the height of PDF output in inches.
Default is typically 8.5.}
}
\value{
A list of ggplot objects of volcano plots for each taxonomic level.
}
\description{
Creates volcano plots visualizing longitudinal taxa trends and significance.
}
\examples{
\dontrun{
data("subset_T2D.obj")
test.list <- generate_taxa_trend_test_long(
  data.obj = subset_T2D.obj,
  subject.var = "subject_id",
  time.var = "visit_number",
  group.var = "subject_race",
  adj.vars = "sample_body_site",
  prev.filter = 0.1,
  abund.filter = 0.001,
  feature.level = c("Genus","Family"),
  feature.dat.type = c("count")
)

plot.list <- generate_taxa_trend_volcano_long(
  data.obj = subset_T2D.obj,
  group.var = "subject_race",
  time.var = "visit_number_num",
  test.list = test.list,
  feature.sig.level = 0.1,
  feature.mt.method = "none")

generate_taxa_trend_test_long(
  data.obj = ecam.obj,
  subject.var = "studyid",
  time.var = "month_num",
  group.var = NULL,
  feature.level = c("Phylum","Class"),
  feature.dat.type = c("proportion")
)
}

}
