% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_beta_change_boxplot_long.R
\name{generate_beta_change_boxplot_long}
\alias{generate_beta_change_boxplot_long}
\title{Generate Beta Diversity Change Boxplot for Longitudinal Data}
\usage{
generate_beta_change_boxplot_long(
  data.obj = NULL,
  dist.obj = NULL,
  subject.var,
  time.var,
  t0.level = NULL,
  ts.levels = NULL,
  group.var = NULL,
  strata.var = NULL,
  adj.vars = NULL,
  dist.name = c("BC", "Jaccard"),
  base.size = 16,
  theme.choice = "bw",
  custom.theme = NULL,
  palette = NULL,
  pdf = TRUE,
  file.ann = NULL,
  pdf.wid = 11,
  pdf.hei = 8.5,
  ...
)
}
\arguments{
\item{data.obj}{A MicrobiomeStat data object, which is a list containing
at minimum the following components:
\itemize{
  \item \code{feature.tab}: A matrix of feature abundances (taxa/genes as
    rows, samples as columns)
  \item \code{meta.dat}: A data frame of sample metadata (samples as rows)
}
Optional components include:
\itemize{
  \item \code{feature.ann}: A matrix/data frame of feature annotations
    (e.g., taxonomy)
  \item \code{tree}: A phylogenetic tree object (class "phylo")
  \item \code{feature.agg.list}: Pre-aggregated feature tables by taxonomy
}
Data objects can be created using converters like
\code{\link{mStat_convert_phyloseq_to_data_obj}} or importers like
\code{\link{mStat_import_qiime2_as_data_obj}}.}

\item{dist.obj}{A list of pre-calculated distance matrices. If NULL and
distances are needed, they will be calculated automatically.
List names should match dist.name (e.g., "BC" for Bray-Curtis).
See \code{\link{mStat_calculate_beta_diversity}}.}

\item{subject.var}{Character string specifying the column name in meta.dat
that uniquely identifies each subject or sample unit. Required for
longitudinal and paired designs to track repeated measurements.}

\item{time.var}{Character string specifying the column name in meta.dat
containing the time variable. Required for longitudinal and paired analyses.
Should be a factor or character with meaningful time point labels.}

\item{t0.level}{Character or numeric value specifying the baseline time
point for longitudinal or paired analyses. Should match a value in the
time.var column.}

\item{ts.levels}{Character vector specifying the follow-up time points for
longitudinal or paired analyses. Should match values in the time.var column.}

\item{group.var}{Character string specifying the column name in meta.dat
containing the grouping variable (e.g., treatment, condition, phenotype).
Used for between-group comparisons.}

\item{strata.var}{Character string specifying the column name in meta.dat
for stratification. When provided, analyses and visualizations will be
performed separately within each stratum (e.g., by site, batch, or sex).}

\item{adj.vars}{Character vector specifying column names in meta.dat to be
used as covariates for adjustment in statistical models. These variables
will be included as fixed effects.}

\item{dist.name}{Character vector specifying which distance metrics to use.
Options depend on available methods:
\itemize{
  \item "BC": Bray-Curtis dissimilarity
  \item "Jaccard": Jaccard distance
  \item "UniFrac": Unweighted UniFrac (requires tree)
  \item "GUniFrac": Generalized UniFrac (requires tree)
  \item "WUniFrac": Weighted UniFrac (requires tree)
  \item "JS": Jensen-Shannon divergence
}}

\item{base.size}{Numeric value specifying the base font size for plot text
elements. Default is typically 16.}

\item{theme.choice}{Character string specifying the ggplot2 theme to use.
Options include:
\itemize{
  \item "bw": Black and white theme (theme_bw)
  \item "classic": Classic theme (theme_classic)
  \item "minimal": Minimal theme (theme_minimal)
  \item "prism": GraphPad Prism-like theme
  \item "nature": Nature journal style
  \item "light": Light theme (theme_light)
}
Can also use a custom ggplot2 theme object via custom.theme.}

\item{custom.theme}{A custom ggplot2 theme object to override theme.choice.
Should be created using ggplot2::theme() or a complete theme function.}

\item{palette}{Character vector of colors or a named palette for the plot.
If NULL, uses default MicrobiomeStat color scheme. Can be:
\itemize{
  \item A vector of color codes (e.g., c("#E41A1C", "#377EB8"))
  \item A palette name recognized by the plotting function
}}

\item{pdf}{Logical. If TRUE, saves the plot(s) to PDF file(s) in the
current working directory. Default is TRUE.}

\item{file.ann}{Character string for additional annotation to append to
output filenames. Useful for distinguishing multiple outputs.}

\item{pdf.wid}{Numeric value specifying the width of PDF output in inches.
Default is typically 11.}

\item{pdf.hei}{Numeric value specifying the height of PDF output in inches.
Default is typically 8.5.}

\item{...}{Additional parameters passed on to ggsave()}
}
\value{
A named list of ggplot objects visualizing within-group and between-group beta diversity across time points.
The list contains one plot for each distance metric specified in \code{dist.name}.
Each plot shows boxplots of the within-group and between-group distances at each time point,
with boxes dodge-positioned by the \code{group_var} variable if provided.
A line plot connecting the medians of boxes is overlaid to show the trajectory over time.
}
\description{
Creates boxplots comparing within-group and between-group beta diversity
across multiple time points. Useful for visualizing temporal changes in
community composition differences.
}
\examples{
\dontrun{
# Load required libraries and example data
library(vegan)
data(peerj32.obj)
dist.obj <- mStat_calculate_beta_diversity(peerj32.obj, dist.name = "BC")
generate_beta_change_boxplot_long(
  data.obj = peerj32.obj,
  dist.obj = NULL,
  subject.var = "subject",
  time.var = "time",
  group.var = "group",
  strata.var = "sex",
  adj.vars = "sex",
  t0.level = "1",
  dist.name = c('BC'),
  base.size = 20,
  theme.choice = "bw",
  custom.theme = NULL,
  palette = "lancet",
  pdf = TRUE,
  file.ann = NULL,
  pdf.wid = 11,
  pdf.hei = 8.5
)

data("subset_pairs.obj")
generate_beta_change_boxplot_long(
  data.obj = subset_pairs.obj,
  dist.obj = NULL,
  subject.var = "MouseID",
  time.var = "Antibiotic",
  group.var = "Sex",
  t0.level = "Baseline",
  dist.name = c('BC'),
  base.size = 20,
  theme.choice = "bw",
  custom.theme = NULL,
  palette = "lancet",
  pdf = TRUE,
  file.ann = NULL,
  pdf.wid = 11,
  pdf.hei = 8.5
)

data("subset_T2D.obj")
generate_beta_change_boxplot_long(
  data.obj = subset_T2D.obj,
  dist.obj = NULL,
  subject.var = "subject_id",
  time.var = "visit_number",
  t0.level = unique(subset_T2D.obj$meta.dat$visit_number)[1],
  ts.levels = unique(subset_T2D.obj$meta.dat$visit_number)[-1],
  group.var = "subject_gender",
  dist.name = c('BC'),
  base.size = 20,
  theme.choice = "bw",
  custom.theme = NULL,
  palette = "lancet",
  pdf = TRUE,
  file.ann = NULL,
  pdf.wid = 11,
  pdf.hei = 8.5
)

generate_beta_change_boxplot_long(
  data.obj = subset_T2D.obj,
  dist.obj = NULL,
  subject.var = "subject_id",
  time.var = "visit_number",
  t0.level = unique(subset_T2D.obj$meta.dat$visit_number)[1],
  ts.levels = unique(subset_T2D.obj$meta.dat$visit_number)[-1],
  group.var = "subject_race",
  dist.name = c('BC'),
  base.size = 20,
  theme.choice = "bw",
  custom.theme = NULL,
  palette = "lancet",
  pdf = TRUE,
  file.ann = NULL,
  pdf.wid = 11,
  pdf.hei = 8.5
)

data("ecam.obj")
generate_beta_change_boxplot_long(
  data.obj = ecam.obj,
  dist.obj = NULL,
  subject.var = "subject.id",
  time.var = "month",
  t0.level = unique(ecam.obj$meta.dat$month)[1],
  ts.levels = unique(ecam.obj$meta.dat$month)[-1],
  group.var = "diet",
  dist.name = c('BC'),
  base.size = 20,
  theme.choice = "bw",
  custom.theme = NULL,
  palette = "lancet",
  pdf = TRUE,
  file.ann = NULL,
  pdf.wid = 11,
  pdf.hei = 8.5
)
generate_beta_change_boxplot_long(
  data.obj = ecam.obj,
  dist.obj = NULL,
  subject.var = "subject.id",
  time.var = "month",
  t0.level = unique(ecam.obj$meta.dat$month)[1],
  ts.levels = unique(ecam.obj$meta.dat$month)[-1],
  group.var = "diet",
  strata.var = "delivery",
  dist.name = c('BC'),
  base.size = 20,
  theme.choice = "bw",
  custom.theme = NULL,
  palette = "lancet",
  pdf = TRUE,
  file.ann = NULL,
  pdf.wid = 11,
  pdf.hei = 8.5
)
}
}
\seealso{
\code{\link[MicrobiomeStat]{mStat_calculate_beta_diversity}} for creating the distance object.
}
