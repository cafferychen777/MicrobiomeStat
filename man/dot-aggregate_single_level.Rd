% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mStat_aggregate_by_taxonomy.R
\name{.aggregate_single_level}
\alias{.aggregate_single_level}
\title{Core Taxonomy Aggregation Function}
\usage{
.aggregate_single_level(feature.tab, feature.ann, feature.level)
}
\arguments{
\item{feature.tab}{Feature table (matrix or data.frame) with taxa as rows and samples as columns.}

\item{feature.ann}{Taxonomy annotation table (matrix or data.frame) with taxa as rows.}

\item{feature.level}{Single character string specifying the taxonomy level to aggregate by.}
}
\value{
Aggregated feature table as a matrix with taxonomy groups as rows and samples as columns.
}
\description{
Internal function that performs the actual aggregation of a feature
table by a single taxonomy level. This is the computational core shared by all
public aggregation interfaces.
}
\details{
The aggregation process:
1. Validates consistency between feature and taxonomy tables
2. Joins tables by row names (inner join - only matching features retained)
3. Reshapes to long format, groups by taxonomy level, sums abundances
4. Reshapes back to wide format
5. Replaces NA taxonomy values with "Unclassified"
6. Removes zero-sum rows
}
\keyword{internal}
