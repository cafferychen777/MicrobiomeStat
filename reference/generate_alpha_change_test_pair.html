<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compare alpha diversity between time points — generate_alpha_change_test_pair • MicrobiomeStat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compare alpha diversity between time points — generate_alpha_change_test_pair"><meta name="description" content="This function performs paired tests to compare alpha diversity metrics
between two time points in a microbiome dataset."><meta property="og:description" content="This function performs paired tests to compare alpha diversity metrics
between two time points in a microbiome dataset."><meta property="og:image" content="https://cafferychen777.github.io/MicrobiomeStat/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MicrobiomeStat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/cafferychen777/MicrobiomeStat"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compare alpha diversity between time points</h1>
      <small class="dont-index">Source: <a href="https://github.com/cafferychen777/MicrobiomeStat/blob/main/R/generate_alpha_change_test_pair.R" class="external-link"><code>R/generate_alpha_change_test_pair.R</code></a></small>
      <div class="d-none name"><code>generate_alpha_change_test_pair.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs paired tests to compare alpha diversity metrics
between two time points in a microbiome dataset.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generate_alpha_change_test_pair</span><span class="op">(</span></span>
<span>  <span class="va">data.obj</span>,</span>
<span>  alpha.obj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  depth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">time.var</span>,</span>
<span>  <span class="va">subject.var</span>,</span>
<span>  <span class="va">group.var</span>,</span>
<span>  adj.vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">change.base</span>,</span>
<span>  alpha.change.func <span class="op">=</span> <span class="st">"log fold change"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-obj">data.obj<a class="anchor" aria-label="anchor" href="#arg-data-obj"></a></dt>
<dd><p>A list object in a format specific to MicrobiomeStat, which can include components such as feature.tab (matrix), feature.ann (matrix), meta.dat (data.frame), tree, and feature.agg.list (list). The data.obj can be converted from other formats using several functions from the MicrobiomeStat package, including: 'mStat_convert_DGEList_to_data_obj', 'mStat_convert_DESeqDataSet_to_data_obj', 'mStat_convert_phyloseq_to_data_obj', 'mStat_convert_SummarizedExperiment_to_data_obj', 'mStat_import_qiime2_as_data_obj', 'mStat_import_mothur_as_data_obj', 'mStat_import_dada2_as_data_obj', and 'mStat_import_biom_as_data_obj'. Alternatively, users can construct their own data.obj. Note that not all components of data.obj may be required for all functions in the MicrobiomeStat package.</p></dd>


<dt id="arg-alpha-obj">alpha.obj<a class="anchor" aria-label="anchor" href="#arg-alpha-obj"></a></dt>
<dd><p>An optional list containing pre-calculated alpha diversity indices. If NULL (default), alpha diversity indices will be calculated using mStat_calculate_alpha_diversity function from MicrobiomeStat package.</p></dd>


<dt id="arg-alpha-name">alpha.name<a class="anchor" aria-label="anchor" href="#arg-alpha-name"></a></dt>
<dd><p>The alpha diversity index to be plotted. Supported indices include "shannon", "simpson", "observed_species", "chao1", "ace", and "pielou". Previously named as `alpha.index`.</p></dd>


<dt id="arg-depth">depth<a class="anchor" aria-label="anchor" href="#arg-depth"></a></dt>
<dd><p>An integer specifying the sequencing depth for the "Rarefy" and "Rarefy-TSS" methods.
If NULL, no rarefaction is performed.</p></dd>


<dt id="arg-time-var">time.var<a class="anchor" aria-label="anchor" href="#arg-time-var"></a></dt>
<dd><p>Character string specifying the column name in metadata containing
time values for each sample. Required to identify pairs of time
points to calculate changes between.</p></dd>


<dt id="arg-subject-var">subject.var<a class="anchor" aria-label="anchor" href="#arg-subject-var"></a></dt>
<dd><p>Character string specifying the column name in metadata containing
unique subject IDs. Required to pair samples from the same subject
across time points.</p></dd>


<dt id="arg-group-var">group.var<a class="anchor" aria-label="anchor" href="#arg-group-var"></a></dt>
<dd><p>Character string specifying the column name in metadata containing
grouping categories. Used as a predictor in the models to test for
differences in changes between groups. Optional, can be NULL.</p></dd>


<dt id="arg-adj-vars">adj.vars<a class="anchor" aria-label="anchor" href="#arg-adj-vars"></a></dt>
<dd><p>Character vector specifying column names in metadata containing
covariates to adjust for in the linear models. Optional, can be
left NULL if no adjustment is needed.</p></dd>


<dt id="arg-change-base">change.base<a class="anchor" aria-label="anchor" href="#arg-change-base"></a></dt>
<dd><p>The name of the baseline time point for calculating changes in alpha diversity. If NULL, the first unique time point in the data will be used.</p></dd>


<dt id="arg-alpha-change-func">alpha.change.func<a class="anchor" aria-label="anchor" href="#arg-alpha-change-func"></a></dt>
<dd><p>Function or method for calculating change in alpha diversity
  between two timepoints. This allows flexible options to quantify change:</p>
<p>- If a function is provided: The function will be applied to compare alpha diversity
    at timepoint t vs baseline t0. The function should take two arguments
    representing the alpha diversity values at t and t0. For instance, a custom function to
    calculate the percentage change might look like:</p><div class="sourceCode"><pre><code><span></span>
<span>      <span class="va">percentage_change</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">t0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="va">t0</span><span class="op">)</span> <span class="op">/</span> <span class="va">t0</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>      <span class="op">}</span></span>
<span>    </span></code></pre></div><p>You can then pass this function as the value for `alpha.change.func`.</p>
<p>- If a string is provided, the following options are supported:
    - 'log fold change': Calculates the log2 fold change of alpha diversity at t compared to t0.
    - 'absolute change': Calculates the absolute difference in alpha diversity at t compared to t0.
    - Any other value: A warning will be given that the provided method is not recognized,
      and the default method ('absolute change') will be used.</p>
<p>- Default behavior (if no recognized string or function is provided) is to compute the absolute difference between t and t0.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of tables, one for each alpha diversity metric, summarizing the results of the statistical tests.
Each table contains the following columns: Term (the name of the variable in the model), Estimate (the estimated coefficient),
Std.Error (the standard error of the coefficient), Statistic (the t or F statistic), P.Value (the p-value of the test).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each alpha diversity metric, the difference between the two time points
is calculated for each subject. The difference is used as the response
variable in a linear model, with grouping and adjustment variables as
predictors.</p>
<p>The linear model coefficients are extracted into a results table. If the
grouping variable has multiple levels, ANOVA is performed to test for overall
significance.</p>
<p>Options are provided to customize the alpha diversity difference calculation
(e.g. log-fold change) and adjust for covariates.</p>
<p>In summary, this provides a flexible paired test for analyzing changes in
alpha diversity over time, accounting for groups and covariates.</p>

<p>This function performs the following statistical tests:</p>
<p>- For each alpha diversity metric, a linear model is fitted with the difference in alpha diversity between two time points as the response, and the grouping variable and any adjustment variables as predictors.
The linear model coefficients are extracted and formatted into a results table.</p>
<p>- If the grouping variable has more than 2 levels, ANOVA is performed on the linear model to obtain the overall significance of the grouping variable.
The ANOVA results are also formatted into the results table.</p>
<p>So in summary, the function provides a paired test for the change in alpha diversity between two time points,
with options to adjust for covariates and test for differences between groups. The output contains coefficient tables
summarizing the results of the linear models and ANOVA tests.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan" class="external-link">vegan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">peerj32.obj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Using both group.var and adj.vars</span></span></span>
<span class="r-in"><span><span class="fu">generate_alpha_change_test_pair</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>,</span></span>
<span class="r-in"><span>  alpha.obj <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  time.var <span class="op">=</span> <span class="st">"time"</span>,</span></span>
<span class="r-in"><span>  alpha.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shannon"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  subject.var <span class="op">=</span> <span class="st">"subject"</span>,</span></span>
<span class="r-in"><span>  group.var <span class="op">=</span> <span class="st">"sex"</span>,</span></span>
<span class="r-in"><span>  adj.vars <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  change.base <span class="op">=</span> <span class="st">"2"</span>,</span></span>
<span class="r-in"><span>  alpha.change.func <span class="op">=</span> <span class="st">"log fold change"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Rename the time variable in peerj32.obj's metadata</span></span></span>
<span class="r-in"><span><span class="va">peerj32.obj</span><span class="op">$</span><span class="va">meta.dat</span> <span class="op">&lt;-</span> <span class="va">peerj32.obj</span><span class="op">$</span><span class="va">meta.dat</span> <span class="op">%&gt;%</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Day <span class="op">=</span> <span class="va">time</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Using group.var and adj.vars with a renamed time variable</span></span></span>
<span class="r-in"><span><span class="fu">generate_alpha_change_test_pair</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>,</span></span>
<span class="r-in"><span>  alpha.obj <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  time.var <span class="op">=</span> <span class="st">"Day"</span>,</span></span>
<span class="r-in"><span>  alpha.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shannon"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  subject.var <span class="op">=</span> <span class="st">"subject"</span>,</span></span>
<span class="r-in"><span>  group.var <span class="op">=</span> <span class="st">"sex"</span>,</span></span>
<span class="r-in"><span>  adj.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  change.base <span class="op">=</span> <span class="st">"2"</span>,</span></span>
<span class="r-in"><span>  alpha.change.func <span class="op">=</span> <span class="st">"log fold change"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"subset_pairs.obj"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: With group.var and without adj.vars</span></span></span>
<span class="r-in"><span><span class="fu">generate_alpha_change_test_pair</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data.obj <span class="op">=</span> <span class="va">subset_pairs.obj</span>,</span></span>
<span class="r-in"><span>  alpha.obj <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  time.var <span class="op">=</span> <span class="st">"Antibiotic"</span>,</span></span>
<span class="r-in"><span>  alpha.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shannon"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  subject.var <span class="op">=</span> <span class="st">"MouseID"</span>,</span></span>
<span class="r-in"><span>  group.var <span class="op">=</span> <span class="st">"Sex"</span>,</span></span>
<span class="r-in"><span>  adj.vars <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  change.base <span class="op">=</span> <span class="st">"Baseline"</span>,</span></span>
<span class="r-in"><span>  alpha.change.func <span class="op">=</span> <span class="st">"log fold change"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xianyang Zhang, Jun Chen, Caffery(Chen) Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

