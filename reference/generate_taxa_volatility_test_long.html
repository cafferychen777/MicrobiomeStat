<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Longitudinal Taxa Abundance Volatility Test — generate_taxa_volatility_test_long • MicrobiomeStat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Longitudinal Taxa Abundance Volatility Test — generate_taxa_volatility_test_long"><meta name="description" content="This function calculates the volatility of taxa abundances in longitudinal microbiome data.
It tests for association between abundance volatility and a grouping variable."><meta property="og:description" content="This function calculates the volatility of taxa abundances in longitudinal microbiome data.
It tests for association between abundance volatility and a grouping variable."><meta property="og:image" content="https://cafferychen777.github.io/MicrobiomeStat/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MicrobiomeStat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/cafferychen777/MicrobiomeStat"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Longitudinal Taxa Abundance Volatility Test</h1>
      <small class="dont-index">Source: <a href="https://github.com/cafferychen777/MicrobiomeStat/blob/main/R/generate_taxa_volatility_test_long.R" class="external-link"><code>R/generate_taxa_volatility_test_long.R</code></a></small>
      <div class="d-none name"><code>generate_taxa_volatility_test_long.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates the volatility of taxa abundances in longitudinal microbiome data.
It tests for association between abundance volatility and a grouping variable.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generate_taxa_volatility_test_long</span><span class="op">(</span></span>
<span>  <span class="va">data.obj</span>,</span>
<span>  <span class="va">time.var</span>,</span>
<span>  <span class="va">subject.var</span>,</span>
<span>  <span class="va">group.var</span>,</span>
<span>  adj.vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prev.filter <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  abund.filter <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">feature.level</span>,</span>
<span>  feature.dat.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"count"</span>, <span class="st">"proportion"</span>, <span class="st">"other"</span><span class="op">)</span>,</span>
<span>  transform <span class="op">=</span> <span class="st">"CLR"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-obj">data.obj<a class="anchor" aria-label="anchor" href="#arg-data-obj"></a></dt>
<dd><p>A list object in a format specific to MicrobiomeStat, which can include components such as feature.tab (matrix), feature.ann (matrix), meta.dat (data.frame), tree, and feature.agg.list (list). The data.obj can be converted from other formats using several functions from the MicrobiomeStat package, including: 'mStat_convert_DGEList_to_data_obj', 'mStat_convert_DESeqDataSet_to_data_obj', 'mStat_convert_phyloseq_to_data_obj', 'mStat_convert_SummarizedExperiment_to_data_obj', 'mStat_import_qiime2_as_data_obj', 'mStat_import_mothur_as_data_obj', 'mStat_import_dada2_as_data_obj', and 'mStat_import_biom_as_data_obj'. Alternatively, users can construct their own data.obj. Note that not all components of data.obj may be required for all functions in the MicrobiomeStat package.</p></dd>


<dt id="arg-time-var">time.var<a class="anchor" aria-label="anchor" href="#arg-time-var"></a></dt>
<dd><p>Character string specifying the column name in metadata containing
the numeric time variable. Should contain ordered time points for each
subject. Required to calculate volatility over time.</p></dd>


<dt id="arg-subject-var">subject.var<a class="anchor" aria-label="anchor" href="#arg-subject-var"></a></dt>
<dd><p>Character string specifying the column name in metadata containing
unique subject IDs. Required to calculate volatility within subjects
over time.</p></dd>


<dt id="arg-group-var">group.var<a class="anchor" aria-label="anchor" href="#arg-group-var"></a></dt>
<dd><p>Character string specifying the column name in metadata containing
grouping categories. Volatility will be compared between groups using
linear models. Required.</p></dd>


<dt id="arg-adj-vars">adj.vars<a class="anchor" aria-label="anchor" href="#arg-adj-vars"></a></dt>
<dd><p>Character vector specifying column names in metadata containing covariates
to adjust for in linear models. Optional, can be NULL.</p></dd>


<dt id="arg-prev-filter">prev.filter<a class="anchor" aria-label="anchor" href="#arg-prev-filter"></a></dt>
<dd><p>Numeric value specifying the minimum prevalence threshold for filtering
taxa before analysis. Taxa with prevalence below this value will be removed.
Prevalence is calculated as the proportion of samples where the taxon is present.</p></dd>


<dt id="arg-abund-filter">abund.filter<a class="anchor" aria-label="anchor" href="#arg-abund-filter"></a></dt>
<dd><p>Numeric value specifying the minimum abundance threshold for filtering
taxa before analysis. Taxa with mean abundance below this value will be removed.
Abundance refers to counts or proportions depending on <code>feature.dat.type</code>.</p></dd>


<dt id="arg-feature-level">feature.level<a class="anchor" aria-label="anchor" href="#arg-feature-level"></a></dt>
<dd><p>Character vector specifying taxonomic level(s) to aggregate abundance data to
before volatility calculation, e.g. c("Phylum", "Genus"). The special value
"original" can also be provided, which will use the original taxon identifiers.</p></dd>


<dt id="arg-feature-dat-type">feature.dat.type<a class="anchor" aria-label="anchor" href="#arg-feature-dat-type"></a></dt>
<dd><p>Character string specifying the data type of the abundance data. Should be
one of "count", "proportion", or "other". Determines transform. This should
match the units of data used in feature.level.</p></dd>


<dt id="arg-transform">transform<a class="anchor" aria-label="anchor" href="#arg-transform"></a></dt>
<dd><p>Character string specifying transformation method. If "CLR", count and
proportion data will be CLR transformed before volatility calculation.
Default "CLR".</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to other methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of test results. The results are returned in a tidy dataframe format, including coefficients, standard errors, statistics, and p-values from linear models and ANOVA tests.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Volatility is calculated as the mean absolute difference in abundance between
consecutive time points, normalized by time difference:
  mean(|abundance(t+1) - abundance(t)| / (time(t+1) - time(t)))</p>
<p>The function transforms the abundance data first before volatility calculation.
Default transform is 'CLR' for count and proportion data. No transform for other types.</p>
<p>For count data, a pseudocount of 0.5 is added before CLR transform.
For proportion data, zeros are replaced with 1/2 of the minimum positive value before CLR.</p>
<p>It then calculates volatility within each subject, and tests for association with
the grouping variable using linear models. If the grouping variable has multiple levels,
an ANOVA is performed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"subset_T2D.obj"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test.list</span> <span class="op">&lt;-</span> <span class="fu">generate_taxa_volatility_test_long</span><span class="op">(</span></span></span>
<span class="r-in"><span>data.obj <span class="op">=</span> <span class="va">subset_T2D.obj</span>,</span></span>
<span class="r-in"><span>time.var <span class="op">=</span> <span class="st">"visit_number"</span>,</span></span>
<span class="r-in"><span>subject.var <span class="op">=</span> <span class="st">"subject_id"</span>,</span></span>
<span class="r-in"><span>group.var <span class="op">=</span> <span class="st">"subject_race"</span>,</span></span>
<span class="r-in"><span>adj.vars <span class="op">=</span> <span class="st">"sample_body_site"</span>,</span></span>
<span class="r-in"><span>prev.filter <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>abund.filter <span class="op">=</span> <span class="fl">0.0001</span>,</span></span>
<span class="r-in"><span>feature.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Genus"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>feature.dat.type <span class="op">=</span> <span class="st">"count"</span>,</span></span>
<span class="r-in"><span>transform <span class="op">=</span> <span class="st">"CLR"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plot.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_taxa_volatility_volcano_long.html">generate_taxa_volatility_volcano_long</a></span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">subset_T2D.obj</span>,</span></span>
<span class="r-in"><span>                                                   group.var <span class="op">=</span> <span class="st">"subject_race"</span>,</span></span>
<span class="r-in"><span>                                                   test.list <span class="op">=</span> <span class="va">test.list</span>,</span></span>
<span class="r-in"><span>                                                   feature.sig.level <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                                                   feature.mt.method <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ecam.obj"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test.list</span> <span class="op">&lt;-</span> <span class="fu">generate_taxa_volatility_test_long</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data.obj <span class="op">=</span> <span class="va">ecam.obj</span>,</span></span>
<span class="r-in"><span>  time.var <span class="op">=</span> <span class="st">"month_num"</span>,</span></span>
<span class="r-in"><span>  subject.var <span class="op">=</span> <span class="st">"subject.id"</span>,</span></span>
<span class="r-in"><span>  group.var <span class="op">=</span> <span class="st">"antiexposedall"</span>,</span></span>
<span class="r-in"><span>  adj.vars <span class="op">=</span> <span class="st">"delivery"</span>,</span></span>
<span class="r-in"><span>  prev.filter <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>  abund.filter <span class="op">=</span> <span class="fl">0.0001</span>,</span></span>
<span class="r-in"><span>  feature.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Order"</span>, <span class="st">"Family"</span>, <span class="st">"Genus"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  feature.dat.type <span class="op">=</span> <span class="st">"proportion"</span>,</span></span>
<span class="r-in"><span>  transform <span class="op">=</span> <span class="st">"CLR"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plot.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_taxa_volatility_volcano_long.html">generate_taxa_volatility_volcano_long</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data.obj <span class="op">=</span> <span class="va">ecam.obj</span>,</span></span>
<span class="r-in"><span>  group.var <span class="op">=</span> <span class="st">"antiexposedall"</span>,</span></span>
<span class="r-in"><span>  test.list <span class="op">=</span> <span class="va">test.list</span>,</span></span>
<span class="r-in"><span>  feature.sig.level <span class="op">=</span> <span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>  feature.mt.method <span class="op">=</span> <span class="st">"none"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xianyang Zhang, Jun Chen, Caffery(Chen) Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

