<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Longitudinal Alpha Diversity Test in Microbiome Data — generate_alpha_per_time_test_long • MicrobiomeStat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Longitudinal Alpha Diversity Test in Microbiome Data — generate_alpha_per_time_test_long"><meta name="description" content="This function performs alpha diversity testing at multiple time points in longitudinal microbiome data.
It applies linear model analyses to assess the diversity of microbial communities over time within different groups or under various conditions."><meta property="og:description" content="This function performs alpha diversity testing at multiple time points in longitudinal microbiome data.
It applies linear model analyses to assess the diversity of microbial communities over time within different groups or under various conditions."><meta property="og:image" content="https://cafferychen777.github.io/MicrobiomeStat/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MicrobiomeStat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/cafferychen777/MicrobiomeStat"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Longitudinal Alpha Diversity Test in Microbiome Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/cafferychen777/MicrobiomeStat/blob/HEAD/R/generate_alpha_per_time_test_long.R" class="external-link"><code>R/generate_alpha_per_time_test_long.R</code></a></small>
      <div class="d-none name"><code>generate_alpha_per_time_test_long.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs alpha diversity testing at multiple time points in longitudinal microbiome data.
It applies linear model analyses to assess the diversity of microbial communities over time within different groups or under various conditions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generate_alpha_per_time_test_long</span><span class="op">(</span></span>
<span>  <span class="va">data.obj</span>,</span>
<span>  alpha.obj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  depth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">time.var</span>,</span>
<span>  <span class="va">t0.level</span>,</span>
<span>  <span class="va">ts.levels</span>,</span>
<span>  group.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adj.vars <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-obj">data.obj<a class="anchor" aria-label="anchor" href="#arg-data-obj"></a></dt>
<dd><p>A MicrobiomeStat data object containing microbiome data and metadata.</p></dd>


<dt id="arg-alpha-obj">alpha.obj<a class="anchor" aria-label="anchor" href="#arg-alpha-obj"></a></dt>
<dd><p>An optional list containing pre-calculated alpha diversity indices. If NULL (default), alpha diversity indices will be calculated using mStat_calculate_alpha_diversity function from MicrobiomeStat package.</p></dd>


<dt id="arg-alpha-name">alpha.name<a class="anchor" aria-label="anchor" href="#arg-alpha-name"></a></dt>
<dd><p>character vector containing the names of alpha diversity indices to calculate.
Possible values are: "shannon", "simpson", "observed_species", "chao1", "ace", and "pielou".</p></dd>


<dt id="arg-depth">depth<a class="anchor" aria-label="anchor" href="#arg-depth"></a></dt>
<dd><p>An integer specifying the sequencing depth for the "Rarefy" and "Rarefy-TSS" methods.
If NULL, no rarefaction is performed.</p></dd>


<dt id="arg-time-var">time.var<a class="anchor" aria-label="anchor" href="#arg-time-var"></a></dt>
<dd><p>A string representing the time variable in the meta.dat.</p></dd>


<dt id="arg-t-level">t0.level<a class="anchor" aria-label="anchor" href="#arg-t-level"></a></dt>
<dd><p>A baseline time point for longitudinal analysis, specified as a character
or numeric value, e.g., "week_0" or 0.</p></dd>


<dt id="arg-ts-levels">ts.levels<a class="anchor" aria-label="anchor" href="#arg-ts-levels"></a></dt>
<dd><p>A vector of character strings indicating follow-up time points, such as
c("week_4", "week_8").</p></dd>


<dt id="arg-group-var">group.var<a class="anchor" aria-label="anchor" href="#arg-group-var"></a></dt>
<dd><p>Optional; a string specifying the group variable in meta.dat for between-group comparisons.</p></dd>


<dt id="arg-adj-vars">adj.vars<a class="anchor" aria-label="anchor" href="#arg-adj-vars"></a></dt>
<dd><p>Optional; a vector of strings representing covariates in meta.dat for adjustment in the analysis.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list where each element corresponds to a different time point and contains the results of alpha diversity tests for that time point.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Analyzing the ECAM dataset (without providing alpha.obj)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ecam.obj"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform the longitudinal alpha diversity test for the ECAM dataset</span></span></span>
<span class="r-in"><span><span class="va">alpha_test_results_ecam</span> <span class="op">&lt;-</span> <span class="fu">generate_alpha_per_time_test_long</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data.obj <span class="op">=</span> <span class="va">ecam.obj</span>,</span></span>
<span class="r-in"><span>  alpha.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shannon"</span>, <span class="st">"simpson"</span>, <span class="st">"observed_species"</span>, <span class="st">"pielou"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  time.var <span class="op">=</span> <span class="st">"month"</span>,</span></span>
<span class="r-in"><span>  t0.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">month</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  ts.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">month</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  group.var <span class="op">=</span> <span class="st">"delivery"</span>,</span></span>
<span class="r-in"><span>  adj.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diet"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate dot plots for the ECAM dataset results</span></span></span>
<span class="r-in"><span><span class="va">dot_plots_ecam</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_alpha_per_time_dotplot_long.html">generate_alpha_per_time_dotplot_long</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data.obj <span class="op">=</span> <span class="va">ecam.obj</span>,</span></span>
<span class="r-in"><span>  test.list <span class="op">=</span> <span class="va">alpha_test_results_ecam</span>,</span></span>
<span class="r-in"><span>  group.var <span class="op">=</span> <span class="st">"delivery"</span>,</span></span>
<span class="r-in"><span>  time.var <span class="op">=</span> <span class="st">"month"</span>,</span></span>
<span class="r-in"><span>  t0.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">month</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  ts.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">month</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  base.size <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>  theme.choice <span class="op">=</span> <span class="st">"bw"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Analyzing the Type 2 Diabetes (T2D) dataset (with providing alpha.obj)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"subset_T2D.obj"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate alpha diversity indices</span></span></span>
<span class="r-in"><span><span class="va">alpha.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="mStat_calculate_alpha_diversity.html">mStat_calculate_alpha_diversity</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">subset_T2D.obj</span><span class="op">$</span><span class="va">feature.tab</span>,</span></span>
<span class="r-in"><span>  alpha.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shannon"</span>, <span class="st">"simpson"</span>, <span class="st">"observed_species"</span>, <span class="st">"chao1"</span>, <span class="st">"ace"</span>, <span class="st">"pielou"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform the longitudinal alpha diversity test for the T2D dataset</span></span></span>
<span class="r-in"><span><span class="va">alpha_test_results_T2D</span> <span class="op">&lt;-</span> <span class="fu">generate_alpha_per_time_test_long</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data.obj <span class="op">=</span> <span class="va">subset_T2D.obj</span>,</span></span>
<span class="r-in"><span>  alpha.obj <span class="op">=</span> <span class="va">alpha.obj</span>,</span></span>
<span class="r-in"><span>  alpha.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shannon"</span>, <span class="st">"simpson"</span>, <span class="st">"observed_species"</span>, <span class="st">"chao1"</span>, <span class="st">"ace"</span>, <span class="st">"pielou"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  time.var <span class="op">=</span> <span class="st">"visit_number_num"</span>,</span></span>
<span class="r-in"><span>  t0.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">subset_T2D.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">visit_number_num</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  ts.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">subset_T2D.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">visit_number_num</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  group.var <span class="op">=</span> <span class="st">"subject_race"</span>,</span></span>
<span class="r-in"><span>  adj.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample_body_site"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate dot plots for the T2D dataset results</span></span></span>
<span class="r-in"><span><span class="va">dot_plots_T2D</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_alpha_per_time_dotplot_long.html">generate_alpha_per_time_dotplot_long</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data.obj <span class="op">=</span> <span class="va">subset_T2D.obj</span>,</span></span>
<span class="r-in"><span>  test.list <span class="op">=</span> <span class="va">alpha_test_results_T2D</span>,</span></span>
<span class="r-in"><span>  group.var <span class="op">=</span> <span class="st">"subject_race"</span>,</span></span>
<span class="r-in"><span>  time.var <span class="op">=</span> <span class="st">"visit_number_num"</span>,</span></span>
<span class="r-in"><span>  t0.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">subset_T2D.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">visit_number_num</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  ts.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">subset_T2D.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">visit_number_num</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  base.size <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>  theme.choice <span class="op">=</span> <span class="st">"bw"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Analyzing the ECAM dataset without adjustment variables</span></span></span>
<span class="r-in"><span><span class="va">alpha_test_results_ecam_no_adj</span> <span class="op">&lt;-</span> <span class="fu">generate_alpha_per_time_test_long</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data.obj <span class="op">=</span> <span class="va">ecam.obj</span>,</span></span>
<span class="r-in"><span>  alpha.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shannon"</span>, <span class="st">"simpson"</span>, <span class="st">"observed_species"</span>, <span class="st">"pielou"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  depth <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>  time.var <span class="op">=</span> <span class="st">"month"</span>,</span></span>
<span class="r-in"><span>  t0.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">month</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  ts.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">month</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  group.var <span class="op">=</span> <span class="st">"delivery"</span>,</span></span>
<span class="r-in"><span>  adj.vars <span class="op">=</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate dot plots for the ECAM dataset results without adjustment variables</span></span></span>
<span class="r-in"><span><span class="va">dot_plots_ecam_no_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_alpha_per_time_dotplot_long.html">generate_alpha_per_time_dotplot_long</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data.obj <span class="op">=</span> <span class="va">ecam.obj</span>,</span></span>
<span class="r-in"><span>  test.list <span class="op">=</span> <span class="va">alpha_test_results_ecam_no_adj</span>,</span></span>
<span class="r-in"><span>  group.var <span class="op">=</span> <span class="st">"delivery"</span>,</span></span>
<span class="r-in"><span>  time.var <span class="op">=</span> <span class="st">"month"</span>,</span></span>
<span class="r-in"><span>  t0.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">month</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  ts.levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">month</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  base.size <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>  theme.choice <span class="op">=</span> <span class="st">"minimal"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xianyang Zhang, Jun Chen, Caffery(Chen) Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

