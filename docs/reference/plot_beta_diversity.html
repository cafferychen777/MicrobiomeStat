<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot Beta Diversity — plot_beta_diversity • MicrobiomeStat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Beta Diversity — plot_beta_diversity"><meta name="description" content="This function, part of the MicrobiomeStat package, generates various types of plots
to visualize beta diversity measures in microbiome data. It supports different
visualization schemes for single time point, paired time points, and longitudinal data."><meta property="og:description" content="This function, part of the MicrobiomeStat package, generates various types of plots
to visualize beta diversity measures in microbiome data. It supports different
visualization schemes for single time point, paired time points, and longitudinal data."><meta property="og:image" content="https://cafferychen777.github.io/MicrobiomeStat/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MicrobiomeStat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/cafferychen777/MicrobiomeStat" aria-label="GitHub repository"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot Beta Diversity</h1>
      <small class="dont-index">Source: <a href="https://github.com/cafferychen777/MicrobiomeStat/blob/HEAD/R/plot_beta_diversity.R" class="external-link"><code>R/plot_beta_diversity.R</code></a></small>
      <div class="d-none name"><code>plot_beta_diversity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function, part of the MicrobiomeStat package, generates various types of plots
to visualize beta diversity measures in microbiome data. It supports different
visualization schemes for single time point, paired time points, and longitudinal data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_beta_diversity</span><span class="op">(</span></span>
<span>  <span class="va">dist.obj</span>,</span>
<span>  pc.obj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">meta.dat</span>,</span>
<span>  <span class="va">measure</span>,</span>
<span>  group.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  strata.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subject.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adj.vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">time.point.plot</span>,</span>
<span>  is.plot.change <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PcoA"</span>, <span class="st">"boxplot"</span>, <span class="st">"spaghettiplot"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dist-obj">dist.obj<a class="anchor" aria-label="anchor" href="#arg-dist-obj"></a></dt>
<dd><p>A distance matrix or object containing beta diversity measures.</p></dd>


<dt id="arg-pc-obj">pc.obj<a class="anchor" aria-label="anchor" href="#arg-pc-obj"></a></dt>
<dd><p>A matrix or data frame containing principal coordinates.</p></dd>


<dt id="arg-meta-dat">meta.dat<a class="anchor" aria-label="anchor" href="#arg-meta-dat"></a></dt>
<dd><p>A data frame containing metadata for the samples.</p></dd>


<dt id="arg-measure">measure<a class="anchor" aria-label="anchor" href="#arg-measure"></a></dt>
<dd><p>Character string specifying the beta diversity measure to plot.</p></dd>


<dt id="arg-group-var">group.var<a class="anchor" aria-label="anchor" href="#arg-group-var"></a></dt>
<dd><p>Character string specifying the grouping variable in meta.dat.</p></dd>


<dt id="arg-strata-var">strata.var<a class="anchor" aria-label="anchor" href="#arg-strata-var"></a></dt>
<dd><p>Character string specifying the stratification variable in meta.dat.</p></dd>


<dt id="arg-subject-var">subject.var<a class="anchor" aria-label="anchor" href="#arg-subject-var"></a></dt>
<dd><p>Character string specifying the subject variable in meta.dat.</p></dd>


<dt id="arg-time-var">time.var<a class="anchor" aria-label="anchor" href="#arg-time-var"></a></dt>
<dd><p>Character string specifying the time variable in meta.dat.</p></dd>


<dt id="arg-adj-vars">adj.vars<a class="anchor" aria-label="anchor" href="#arg-adj-vars"></a></dt>
<dd><p>Character vector specifying variables to adjust for. If specified, adjusted PCoA will be performed.</p></dd>


<dt id="arg-time-point-plot">time.point.plot<a class="anchor" aria-label="anchor" href="#arg-time-point-plot"></a></dt>
<dd><p>Character vector specifying time points to plot. The first point will be the reference.</p></dd>


<dt id="arg-is-plot-change">is.plot.change<a class="anchor" aria-label="anchor" href="#arg-is-plot-change"></a></dt>
<dd><p>Logical, whether to plot change from baseline. Only effective when there are multiple time points.</p></dd>


<dt id="arg-plot-type">plot.type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>Character string specifying the plot type, one of c("PCoA", "boxplot", "spaghettiplot").</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to the underlying plotting functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot object representing the beta diversity plot.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function provides a flexible framework for visualizing beta diversity in microbiome data.
It can handle single time point, paired time points, and longitudinal data. The function offers
different plot types including PCoA plots, box plots, and spaghetti plots, and can visualize
changes over time.</p>
<p>The behavior of the function depends on the number of time points specified:
- For a single time point or when time variable is not specified, only PCoA plot is available.
- For two time points, both PCoA and change boxplot are available.
- For more than two time points, PCoA, change boxplot, and change spaghettiplot are available.</p>
<p>When `is.plot.change` is TRUE and multiple time points are specified, the function will calculate
changes from the baseline (first time point).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">peerj32.obj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dist.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="mStat_calculate_beta_diversity.html">mStat_calculate_beta_diversity</a></span><span class="op">(</span><span class="va">peerj32.obj</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BC"</span>, <span class="st">"Jaccard"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>It appears the data may not have been rarefied. Please verify.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Initializing distance objects...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Bray-Curtis dissimilarity...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Jaccard dissimilarity...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> All calculations complete.</span>
<span class="r-in"><span><span class="fu">plot_beta_diversity</span><span class="op">(</span>dist.obj <span class="op">=</span> <span class="va">dist.obj</span>,</span></span>
<span class="r-in"><span>                    meta.dat <span class="op">=</span> <span class="va">peerj32.obj</span><span class="op">$</span><span class="va">meta.dat</span>,</span></span>
<span class="r-in"><span>                    measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BC"</span>, <span class="st">"Jaccard"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    group.var <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>                    time.var <span class="op">=</span> <span class="st">"time"</span>,</span></span>
<span class="r-in"><span>                    time.point.plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    plot.type <span class="op">=</span> <span class="st">"PCoA"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data has been subsetted based on the provided condition.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Updated metadata to match the subsetted data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following samples were excluded: sample-2, sample-4, sample-6, sample-8, sample-10, sample-12, sample-14, sample-16, sample-18, sample-20, sample-22, sample-24, sample-26, sample-28, sample-30, sample-32, sample-34, sample-36, sample-38, sample-40, sample-42, sample-44</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data subsetting complete. Returning updated data object.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating PC...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing BC distance...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating MDS...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing Jaccard distance...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating MDS...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculation complete.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $BC</span>
<span class="r-plt img"><img src="plot_beta_diversity-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Jaccard</span>
<span class="r-plt img"><img src="plot_beta_diversity-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_beta_diversity</span><span class="op">(</span>dist.obj <span class="op">=</span> <span class="va">dist.obj</span>,</span></span>
<span class="r-in"><span>                    meta.dat <span class="op">=</span> <span class="va">peerj32.obj</span><span class="op">$</span><span class="va">meta.dat</span>,</span></span>
<span class="r-in"><span>                    measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BC"</span>, <span class="st">"Jaccard"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    group.var <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>                    subject.var <span class="op">=</span> <span class="st">"subject"</span>,</span></span>
<span class="r-in"><span>                    time.var <span class="op">=</span> <span class="st">"time"</span>,</span></span>
<span class="r-in"><span>                    time.point.plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    plot.type <span class="op">=</span> <span class="st">"PCoA"</span>,</span></span>
<span class="r-in"><span>                    is.plot.change <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating PC...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing BC distance...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating MDS...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing Jaccard distance...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating MDS...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculation complete.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 22 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_segment()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 22 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_segment()`).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $BC</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 22 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_segment()`).</span>
<span class="r-plt img"><img src="plot_beta_diversity-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Jaccard</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 22 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_segment()`).</span>
<span class="r-plt img"><img src="plot_beta_diversity-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_beta_diversity</span><span class="op">(</span>dist.obj <span class="op">=</span> <span class="va">dist.obj</span>,</span></span>
<span class="r-in"><span>                    meta.dat <span class="op">=</span> <span class="va">peerj32.obj</span><span class="op">$</span><span class="va">meta.dat</span>,</span></span>
<span class="r-in"><span>                    measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BC"</span>, <span class="st">"Jaccard"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    group.var <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>                    subject.var <span class="op">=</span> <span class="st">"subject"</span>,</span></span>
<span class="r-in"><span>                    time.var <span class="op">=</span> <span class="st">"time"</span>,</span></span>
<span class="r-in"><span>                    time.point.plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    plot.type <span class="op">=</span> <span class="st">"boxplot"</span>,</span></span>
<span class="r-in"><span>                    is.plot.change <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $BC</span>
<span class="r-plt img"><img src="plot_beta_diversity-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Jaccard</span>
<span class="r-plt img"><img src="plot_beta_diversity-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ecam.obj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dist.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="mStat_calculate_beta_diversity.html">mStat_calculate_beta_diversity</a></span><span class="op">(</span><span class="va">ecam.obj</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BC"</span>, <span class="st">"Jaccard"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>It appears the data may not have been rarefied. Please verify.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Initializing distance objects...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Bray-Curtis dissimilarity...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating Jaccard dissimilarity...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> All calculations complete.</span>
<span class="r-in"><span><span class="fu">plot_beta_diversity</span><span class="op">(</span>dist.obj <span class="op">=</span> <span class="va">dist.obj</span>,</span></span>
<span class="r-in"><span>                    meta.dat <span class="op">=</span> <span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span>,</span></span>
<span class="r-in"><span>                    measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BC"</span>, <span class="st">"Jaccard"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    group.var <span class="op">=</span> <span class="st">"delivery"</span>,</span></span>
<span class="r-in"><span>                    subject.var <span class="op">=</span> <span class="st">"subject.id"</span>,</span></span>
<span class="r-in"><span>                    time.var <span class="op">=</span> <span class="st">"month_num"</span>,</span></span>
<span class="r-in"><span>                    time.point.plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">month_num</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    plot.type <span class="op">=</span> <span class="st">"boxplot"</span>,</span></span>
<span class="r-in"><span>                    is.plot.change <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $BC</span>
<span class="r-plt img"><img src="plot_beta_diversity-7.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Jaccard</span>
<span class="r-plt img"><img src="plot_beta_diversity-8.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_beta_diversity</span><span class="op">(</span>dist.obj <span class="op">=</span> <span class="va">dist.obj</span>,</span></span>
<span class="r-in"><span>                    meta.dat <span class="op">=</span> <span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span>,</span></span>
<span class="r-in"><span>                    measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BC"</span>, <span class="st">"Jaccard"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    group.var <span class="op">=</span> <span class="st">"delivery"</span>,</span></span>
<span class="r-in"><span>                    subject.var <span class="op">=</span> <span class="st">"subject.id"</span>,</span></span>
<span class="r-in"><span>                    time.var <span class="op">=</span> <span class="st">"month_num"</span>,</span></span>
<span class="r-in"><span>                    time.point.plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">month_num</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    plot.type <span class="op">=</span> <span class="st">"spaghettiplot"</span>,</span></span>
<span class="r-in"><span>                    is.plot.change <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: This function requires subjects to have a baseline time point (specified by `t0.level`) to calculate the change in beta diversity. Subjects without a baseline time point will be excluded from the visualization.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $BC</span>
<span class="r-plt img"><img src="plot_beta_diversity-9.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Jaccard</span>
<span class="r-plt img"><img src="plot_beta_diversity-10.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_beta_diversity</span><span class="op">(</span>dist.obj <span class="op">=</span> <span class="va">dist.obj</span>,</span></span>
<span class="r-in"><span>                    meta.dat <span class="op">=</span> <span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span>,</span></span>
<span class="r-in"><span>                    measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BC"</span>, <span class="st">"Jaccard"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    group.var <span class="op">=</span> <span class="st">"delivery"</span>,</span></span>
<span class="r-in"><span>                    subject.var <span class="op">=</span> <span class="st">"subject.id"</span>,</span></span>
<span class="r-in"><span>                    time.var <span class="op">=</span> <span class="st">"month_num"</span>,</span></span>
<span class="r-in"><span>                    time.point.plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ecam.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">$</span><span class="va">month_num</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    plot.type <span class="op">=</span> <span class="st">"PCoA"</span>,</span></span>
<span class="r-in"><span>                    is.plot.change <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating PC...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing BC distance...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating MDS...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing Jaccard distance...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating MDS...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculation complete.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Using alpha for a discrete variable is not advised.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 45 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_segment()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 2 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_segment()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Using alpha for a discrete variable is not advised.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 45 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_segment()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 2 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_segment()`).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $BC</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Using alpha for a discrete variable is not advised.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 45 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_segment()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 2 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_segment()`).</span>
<span class="r-plt img"><img src="plot_beta_diversity-11.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Jaccard</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Using alpha for a discrete variable is not advised.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 45 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_segment()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 2 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_segment()`).</span>
<span class="r-plt img"><img src="plot_beta_diversity-12.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xianyang Zhang, Jun Chen, Caffery(Chen) Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

