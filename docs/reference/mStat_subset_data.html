<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Subset Data Object by Sample IDs in MicrobiomeStat — mStat_subset_data • MicrobiomeStat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Subset Data Object by Sample IDs in MicrobiomeStat — mStat_subset_data"><meta name="description" content="This function is part of the MicrobiomeStat package. It subsets a multi-omics data object by
a specified set of sample IDs. It checks for the presence of various data components in the
data object and subsets them if they exist."><meta property="og:description" content="This function is part of the MicrobiomeStat package. It subsets a multi-omics data object by
a specified set of sample IDs. It checks for the presence of various data components in the
data object and subsets them if they exist."><meta property="og:image" content="https://cafferychen777.github.io/MicrobiomeStat/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MicrobiomeStat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/cafferychen777/MicrobiomeStat"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Subset Data Object by Sample IDs in MicrobiomeStat</h1>
      <small class="dont-index">Source: <a href="https://github.com/cafferychen777/MicrobiomeStat/blob/HEAD/R/mStat_subset_data.R" class="external-link"><code>R/mStat_subset_data.R</code></a></small>
      <div class="d-none name"><code>mStat_subset_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is part of the MicrobiomeStat package. It subsets a multi-omics data object by
a specified set of sample IDs. It checks for the presence of various data components in the
data object and subsets them if they exist.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mStat_subset_data</span><span class="op">(</span><span class="va">data.obj</span>, samIDs <span class="op">=</span> <span class="cn">NULL</span>, condition <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-obj">data.obj<a class="anchor" aria-label="anchor" href="#arg-data-obj"></a></dt>
<dd><p>A list object in a format specific to MicrobiomeStat, which can include components such as feature.tab (matrix), feature.ann (matrix), meta.dat (data.frame), tree, and feature.agg.list (list). The data.obj can be converted from other formats using several functions from the MicrobiomeStat package, including: 'mStat_convert_DGEList_to_data_obj', 'mStat_convert_DESeqDataSet_to_data_obj', 'mStat_convert_phyloseq_to_data_obj', 'mStat_convert_SummarizedExperiment_to_data_obj', 'mStat_import_qiime2_as_data_obj', 'mStat_import_mothur_as_data_obj', 'mStat_import_dada2_as_data_obj', and 'mStat_import_biom_as_data_obj'. Alternatively, users can construct their own data.obj. Note that not all components of data.obj may be required for all functions in the MicrobiomeStat package.
table (`feature.tab`), feature names, a full feature name list, and a feature aggregation list
(`feature.agg.list`).</p></dd>


<dt id="arg-samids">samIDs<a class="anchor" aria-label="anchor" href="#arg-samids"></a></dt>
<dd><p>A vector of sample IDs to subset by. This can be a logical vector, a numeric
vector, or a character vector of sample IDs.</p></dd>


<dt id="arg-condition">condition<a class="anchor" aria-label="anchor" href="#arg-condition"></a></dt>
<dd><p>A logical expression string describing rows to keep. This allows subsetting samples based on metadata, similarly to dplyr::filter. Only one of 'samIDs' and 'condition' should be provided.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list that is the modified version of the input data object. It includes the subsetted
metadata, feature table, feature names, full feature name list, and feature aggregation list.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function first checks if samIDs is logical or numeric, and if so, converts it to a
character vector of sample IDs. It then subsets the metadata by the sample IDs. If a feature
table exists, it subsets the feature table and the feature names by the sample IDs. If a full
feature name list exists, it subsets the full feature name list by the sample IDs. If a feature
aggregation list exists, it subsets each feature aggregation table in the list by the sample IDs.
The function returns the subsetted data object.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Load the required libraries</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cafferychen777.github.io/MicrobiomeStat">MicrobiomeStat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Prepare data for the function</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">peerj32.obj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">peerj32.obj</span><span class="op">$</span><span class="va">meta.dat</span> <span class="op">&lt;-</span> <span class="va">peerj32.obj</span><span class="op">$</span><span class="va">meta.dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu">all_of</span><span class="op">(</span><span class="st">"subject"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,<span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">peerj32.obj</span><span class="op">$</span><span class="va">meta.dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"sample"</span><span class="op">)</span>,by <span class="op">=</span> <span class="st">"subject"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"sample"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Subset data for a specific time point</span></span></span>
<span class="r-in"><span><span class="co"># Subset to include only samples from time point 1</span></span></span>
<span class="r-in"><span><span class="va">subset_time1</span> <span class="op">&lt;-</span> <span class="fu">mStat_subset_data</span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>, condition <span class="op">=</span> <span class="st">"time == '1'"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Subset data for a specific group</span></span></span>
<span class="r-in"><span><span class="co"># Subset to include only samples from the 'LGG' group</span></span></span>
<span class="r-in"><span><span class="va">subset_LGG</span> <span class="op">&lt;-</span> <span class="fu">mStat_subset_data</span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>, condition <span class="op">=</span> <span class="st">"group == 'LGG'"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Subset data for a specific sex</span></span></span>
<span class="r-in"><span><span class="co"># Subset to include only male samples</span></span></span>
<span class="r-in"><span><span class="va">subset_male</span> <span class="op">&lt;-</span> <span class="fu">mStat_subset_data</span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>, condition <span class="op">=</span> <span class="st">"sex == 'male'"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Example 4: Complex condition subsetting</span></span></span>
<span class="r-in"><span><span class="co"># Subset based on multiple conditions: male samples from 'Placebo' group at time point 2</span></span></span>
<span class="r-in"><span><span class="va">complex_condition</span> <span class="op">&lt;-</span> <span class="st">"sex == 'male' &amp; group == 'Placebo' &amp; time == '2'"</span></span></span>
<span class="r-in"><span><span class="va">subset_complex</span> <span class="op">&lt;-</span> <span class="fu">mStat_subset_data</span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>, condition <span class="op">=</span> <span class="va">complex_condition</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Example 5: Subset data using a combination of sample IDs and condition</span></span></span>
<span class="r-in"><span><span class="co"># First, get a subset of sample IDs (e.g., first 10 samples)</span></span></span>
<span class="r-in"><span><span class="va">subset_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">peerj32.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># Subset the data object based on these sample IDs</span></span></span>
<span class="r-in"><span><span class="va">subset_by_ids</span> <span class="op">&lt;-</span> <span class="fu">mStat_subset_data</span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>, samIDs <span class="op">=</span> <span class="va">subset_ids</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Then, further subset the result to include only those samples from the 'Placebo' group</span></span></span>
<span class="r-in"><span><span class="va">subset_ids_condition</span> <span class="op">&lt;-</span> <span class="fu">mStat_subset_data</span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">subset_by_ids</span>,</span></span>
<span class="r-in"><span>condition <span class="op">=</span> <span class="st">"group == 'Placebo'"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Example 6: Subset data for female samples in the 'Placebo' group</span></span></span>
<span class="r-in"><span><span class="co"># Subset to include only female samples from the 'Placebo' group</span></span></span>
<span class="r-in"><span><span class="va">subset_female_placebo</span> <span class="op">&lt;-</span> <span class="fu">mStat_subset_data</span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>,</span></span>
<span class="r-in"><span>condition <span class="op">=</span> <span class="st">"sex == 'female' &amp; group == 'Placebo'"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Example 7: Subset data excluding certain subjects</span></span></span>
<span class="r-in"><span><span class="co"># Subset to exclude subjects S1 and S2</span></span></span>
<span class="r-in"><span><span class="va">subset_exclude_subjects</span> <span class="op">&lt;-</span> <span class="fu">mStat_subset_data</span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>,</span></span>
<span class="r-in"><span>condition <span class="op">=</span> <span class="st">"!subject %in% c('S1', 'S2')"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Example 8: Subset data for a specific range of the 'cons' variable</span></span></span>
<span class="r-in"><span><span class="co"># Subset to include samples with 'cons' values greater than 2</span></span></span>
<span class="r-in"><span><span class="va">subset_cons_gt_2</span> <span class="op">&lt;-</span> <span class="fu">mStat_subset_data</span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>, condition <span class="op">=</span> <span class="st">"cons &gt; 2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Example 9: Subset data for samples with even-numbered IDs</span></span></span>
<span class="r-in"><span><span class="co"># Subset to include samples with even-numbered IDs</span></span></span>
<span class="r-in"><span><span class="va">even_sample_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">peerj32.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">'sample-'</span>, <span class="st">''</span>,</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">peerj32.obj</span><span class="op">$</span><span class="va">meta.dat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">subset_even_samples</span> <span class="op">&lt;-</span> <span class="fu">mStat_subset_data</span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>, samIDs <span class="op">=</span> <span class="va">even_sample_ids</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Example 10: Combine multiple conditions with logical operators</span></span></span>
<span class="r-in"><span><span class="co"># Subset to include male samples from 'LGG' group at time point 1 with 'cons' less than 3</span></span></span>
<span class="r-in"><span><span class="va">complex_multiple_conditions</span> <span class="op">&lt;-</span> <span class="st">"sex == 'male' &amp; group == 'LGG' &amp; time == '1' &amp; cons &lt; 3"</span></span></span>
<span class="r-in"><span><span class="va">subset_complex_multiple</span> <span class="op">&lt;-</span> <span class="fu">mStat_subset_data</span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>,</span></span>
<span class="r-in"><span>condition <span class="op">=</span> <span class="va">complex_multiple_conditions</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xianyang Zhang, Jun Chen, Caffery(Chen) Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

