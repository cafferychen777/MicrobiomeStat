<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Adjust Alpha Diversity Indices Based on Covariates — mStat_calculate_adjusted_alpha_diversity • MicrobiomeStat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adjust Alpha Diversity Indices Based on Covariates — mStat_calculate_adjusted_alpha_diversity"><meta name="description" content="This function adjusts alpha diversity indices for specified covariates using linear regression. The adjusted alpha diversity values are computed for each index by regressing the original values on the covariates and then using the residuals to adjust the original values."><meta property="og:description" content="This function adjusts alpha diversity indices for specified covariates using linear regression. The adjusted alpha diversity values are computed for each index by regressing the original values on the covariates and then using the residuals to adjust the original values."><meta property="og:image" content="https://cafferychen777.github.io/MicrobiomeStat/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MicrobiomeStat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/cafferychen777/MicrobiomeStat"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Adjust Alpha Diversity Indices Based on Covariates</h1>
      <small class="dont-index">Source: <a href="https://github.com/cafferychen777/MicrobiomeStat/blob/HEAD/R/mStat_calculate_adjusted_alpha_diversity.R" class="external-link"><code>R/mStat_calculate_adjusted_alpha_diversity.R</code></a></small>
      <div class="d-none name"><code>mStat_calculate_adjusted_alpha_diversity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function adjusts alpha diversity indices for specified covariates using linear regression. The adjusted alpha diversity values are computed for each index by regressing the original values on the covariates and then using the residuals to adjust the original values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mStat_calculate_adjusted_alpha_diversity</span><span class="op">(</span><span class="va">alpha.obj</span>, <span class="va">meta.dat</span>, <span class="va">adj.vars</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-alpha-obj">alpha.obj<a class="anchor" aria-label="anchor" href="#arg-alpha-obj"></a></dt>
<dd><p>A list where each element is a data frame containing alpha diversity indices.
Each data frame should have samples as rows and a single column named after the alpha diversity index.</p></dd>


<dt id="arg-meta-dat">meta.dat<a class="anchor" aria-label="anchor" href="#arg-meta-dat"></a></dt>
<dd><p>A data frame containing metadata for the samples.
This data frame should include all the covariates specified in `adj.vars` as well as any other variables needed for the analysis.</p></dd>


<dt id="arg-adj-vars">adj.vars<a class="anchor" aria-label="anchor" href="#arg-adj-vars"></a></dt>
<dd><p>A character vector specifying the names of the covariates in `meta.dat`
that should be used to adjust the alpha diversity indices. These variables are used in a linear model to adjust the diversity values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of data frames, structured identically to `alpha.obj`, where each alpha diversity
        index has been adjusted based on the specified covariates. The structure and naming of the
        list and its elements are preserved.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The adjustment is done by fitting a linear model with the alpha diversity index as the
         response and the covariates as predictors. The adjusted values are the original values
         minus the fitted values plus the intercept. This ensures that the adjusted values are on
         the same scale as the original values but have the effect of the covariates removed.</p>
<p>If the covariates include categorical variables, these are converted to factors before
         creating the model matrix. The function will stop with an error if any of the specified
         covariates are not found in the metadata.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="co"># Assuming you have already calculated alpha diversity and have the metadata ready</span></span></span>
<span class="r-in"><span>  <span class="va">alpha.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="mStat_calculate_alpha_diversity.html">mStat_calculate_alpha_diversity</a></span><span class="op">(</span><span class="va">peerj32.obj</span><span class="op">$</span><span class="va">feature.tab</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shannon"</span>, <span class="st">"simpson"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Adjust alpha diversity based on treatment and day</span></span></span>
<span class="r-in"><span>  <span class="va">adjusted.alpha.obj</span> <span class="op">&lt;-</span> <span class="fu">mStat_calculate_adjusted_alpha_diversity</span><span class="op">(</span></span></span>
<span class="r-in"><span>    alpha.obj <span class="op">=</span> <span class="va">alpha.obj</span>,</span></span>
<span class="r-in"><span>    meta.dat <span class="op">=</span> <span class="va">peerj32.obj</span><span class="op">$</span><span class="va">meta.dat</span>,</span></span>
<span class="r-in"><span>    adj.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xianyang Zhang, Jun Chen, Caffery(Chen) Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

