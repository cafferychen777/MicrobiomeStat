<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Generate volcano plots for taxa differential test for a single time point"><title>Generate volcano plots for taxa differential test for a single time point — generate_taxa_volcano_single • MicrobiomeStat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate volcano plots for taxa differential test for a single time point — generate_taxa_volcano_single"><meta property="og:description" content="Generate volcano plots for taxa differential test for a single time point"><meta property="og:image" content="https://cafferychen777.github.io/MicrobiomeStat/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MicrobiomeStat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cafferychen777/MicrobiomeStat">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate volcano plots for taxa differential test for a single time point</h1>
      <small class="dont-index">Source: <a href="https://github.com/cafferychen777/MicrobiomeStat/blob/HEAD/R/generate_taxa_volcano_single.R" class="external-link"><code>R/generate_taxa_volcano_single.R</code></a></small>
      <div class="d-none name"><code>generate_taxa_volcano_single.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generate volcano plots for taxa differential test for a single time point</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generate_taxa_volcano_single</span><span class="op">(</span></span>
<span>  <span class="va">data.obj</span>,</span>
<span>  group.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">test.list</span>,</span>
<span>  feature.sig.level <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  feature.mt.method <span class="op">=</span> <span class="st">"fdr"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data.obj</dt>
<dd><p>A list object in a format specific to MicrobiomeStat, which can include components such as feature.tab (matrix), feature.ann (matrix), meta.dat (data.frame), tree, and feature.agg.list (list). The data.obj can be converted from other formats using several functions from the MicrobiomeStat package, including: 'mStat_convert_DGEList_to_data_obj', 'mStat_convert_DESeqDataSet_to_data_obj', 'mStat_convert_phyloseq_to_data_obj', 'mStat_convert_SummarizedExperiment_to_data_obj', 'mStat_import_qiime2_as_data_obj', 'mStat_import_mothur_as_data_obj', 'mStat_import_dada2_as_data_obj', and 'mStat_import_biom_as_data_obj'. Alternatively, users can construct their own data.obj. Note that not all components of data.obj may be required for all functions in the MicrobiomeStat package.</p></dd>


<dt>group.var</dt>
<dd><p>The grouping variable tested, found in metadata</p></dd>


<dt>test.list</dt>
<dd><p>The list of test results returned by generate_taxa_trend_test_long</p></dd>


<dt>feature.sig.level</dt>
<dd><p>The significance level cutoff for highlighting taxa</p></dd>


<dt>feature.mt.method</dt>
<dd><p>Multiple testing correction method, "fdr" or "none"</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of ggplot objects of volcano plots for each taxonomic level</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">peerj32.obj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_taxa_test_single.html">generate_taxa_test_single</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>,</span></span>
<span class="r-in"><span>    time.var <span class="op">=</span> <span class="st">"time"</span>,</span></span>
<span class="r-in"><span>    t.level <span class="op">=</span> <span class="st">"2"</span>,</span></span>
<span class="r-in"><span>    group.var <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>    adj.vars <span class="op">=</span> <span class="st">"sex"</span>,</span></span>
<span class="r-in"><span>    feature.dat.type <span class="op">=</span> <span class="st">"count"</span>,</span></span>
<span class="r-in"><span>    feature.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Phylum"</span>,<span class="st">"Genus"</span>,<span class="st">"Family"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    prev.filter <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>    abund.filter <span class="op">=</span> <span class="fl">0.0001</span>,</span></span>
<span class="r-in"><span>    feature.sig.level <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>    feature.mt.method <span class="op">=</span> <span class="st">"none"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Rule 1 passed: data.obj is a list.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Rule 2 passed: meta.dat is a data.frame.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Rule 3 passed: The row names of feature.tab match the row names of feature.ann.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Rule 4 passed: The column names of feature.tab match the row names of meta.dat.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Rule 5 passed: feature.tab is a matrix.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Rule 6 passed: feature.ann is a matrix.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Please note: The data components should follow base R data.frame and matrix structures, not phyloseq's formal class.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Validation passed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: Passing validation does not guarantee the absence of all data issues. Further data exploration may be needed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data has been subsetted based on the provided condition.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Updated metadata to match the subsetted data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following samples were excluded: sample-1, sample-3, sample-5, sample-7, sample-9, sample-11, sample-13, sample-15, sample-17, sample-19, sample-21, sample-23, sample-25, sample-27, sample-29, sample-31, sample-33, sample-35, sample-37, sample-39, sample-41, sample-43</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Updated feature table to match the subsetted data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Updated feature annotation to match the subsetted data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data subsetting complete. Returning updated data object.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Your data is in raw format ('Raw'). Normalization is crucial for further analyses. Now, 'mStat_normalize_data' function is automatically applying 'TSS' transformation.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data has been successfully normalized using TSS method.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0 features are filtered!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The filtered data has 22 samples and 6 features that will be tested!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fit linear models ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Completed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0 features are filtered!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The filtered data has 22 samples and 115 features that will be tested!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fit linear models ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Completed.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 0 features are filtered!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The filtered data has 22 samples and 18 features that will be tested!</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fit linear models ...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Completed.</span>
<span class="r-in"><span>   <span class="va">volcano_plots</span> <span class="op">&lt;-</span> <span class="fu">generate_taxa_volcano_single</span><span class="op">(</span>data.obj <span class="op">=</span> <span class="va">peerj32.obj</span>,</span></span>
<span class="r-in"><span>                                                 group.var <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>                                                 test.list <span class="op">=</span> <span class="va">test.list</span>,</span></span>
<span class="r-in"><span>                                                 feature.sig.level <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                                                 feature.mt.method <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Xianyang Zhang, Jun Chen, Caffery(Chen) Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

